                                                                            //Taylor Series Method 
#include <stdio.h>
#include <math.h>

#define MAX_ORDER 5

// Factorial function
double fact(int n) {
    double f = 1.0;
    for (int i = 1; i <= n; i++) f *= i;
    return f;
}

// Compute y, y', y'', y''', y^(4), y^(5)
void compute_derivatives_at(double n0, double y0, double D[]) {

    double y0_ = y0;

    // y'
    double y1 = n0 - y0_ * y0_;

    // y''
    double y2 = 1.0 - 2.0 * y0_ * y1;

    // y'''
    double y3 = -2.0 * (y1 * y1) - 2.0 * y0_ * y2;

    // y^(4)
    double y4 = -2.0 * y0_ * y3 - 6.0 * y1 * y2;

    // y^(5)
    double y5 = -2.0 * y0_ * y4 - 8.0 * y1 * y3 - 6.0 * (y2 * y2);

    D[0] = y0_;
    D[1] = y1;
    D[2] = y2;
    D[3] = y3;
    D[4] = y4;
    D[5] = y5;
}

// Taylor method approximation
double taylor_at(double n0, double y0, double h, int order, double D[]) {

    compute_derivatives_at(n0, y0, D);

    double sum = 0.0;

    for (int k = 0; k <= order; k++) {
        sum += D[k] * pow(h, k) / fact(k);
    }

    return sum;
}

// ---------------- MAIN PROGRAM ----------------

int main() {

    double n0 = 0.0;
    double y0 = 1.0;
    double h  = 0.1;
    int order = 5;

    double D[6];

    double approx = taylor_at(n0, y0, h, order, D);

    printf("Derivatives at n0 = %.4f, y0 = %.4f:\n", n0, y0);

    printf("y'(0)    = %.6f\n", D[1]);
    printf("y''(0)   = %.6f\n", D[2]);
    printf("y'''(0)  = %.6f\n", D[3]);
    printf("y^(4)(0) = %.6f\n", D[4]);
    printf("y^(5)(0) = %.6f\n\n", D[5]);

    printf("Taylor approximation up to order %d:\n", order);
    printf("y(%.4f) â‰ˆ %.10f\n", n0 + h, approx);
    printf("Rounded to 4 decimals: %.4f\n", approx);

    return 0;
}
